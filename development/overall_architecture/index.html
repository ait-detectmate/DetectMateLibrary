<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://ait-detectmate.github.io/DetectMateLibrary/development/overall_architecture/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Overall architecture - DetectMate Library</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/version-select.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Overall architecture";
        var mkdocs_page_input_path = "overall_architecture.md";
        var mkdocs_page_url = "/DetectMateLibrary/development/overall_architecture/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> DetectMate Library
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basic_usage/">Basic usage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../create_components/">Create new component</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../implement_components/">Implement new component</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Components</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Overall architecture</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#components-flow">Components flow</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#components-architecture">Components architecture</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#components-methods">Components methods</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../schemas/">Schemas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parsers/">Parsers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../detectors/">Detectors</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Parsers Methods</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../parsers/template_matcher/">Template Matcher</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parsers/json_parser/">Json Parser</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Detectors Methods</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../detectors/random_detector/">Random Detector</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../detectors/new_value/">New Value</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../detectors/combo/">Combo Detector</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Auxiliar</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../auxiliar/persistency/">Persistency</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../auxiliar/input_buffer/">Data buffer</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Helpers</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../helper/from_to/">From to</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">DetectMate Library</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Components</li>
      <li class="breadcrumb-item active">Overall architecture</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="overall-architecture">Overall architecture</h1>
<p>This document describes the high-level design of DetectMateLibrary, how components interact, the data contracts they use, and guidance for deploying and extending the system. The library is built around small, composable components that operate on streaming log data and exchange strongly-typed Schema objects.</p>
<p>Key goals</p>
<ul>
<li>Clear separation of concerns (reading, parsing, detection, output).</li>
<li>Stream-friendly processing with minimal buffering.</li>
<li>Well-defined schema contracts so components can be composed or run as microservices.</li>
<li>Easy extensibility: add new readers, parsers or detectors by subclassing core base classes.</li>
</ul>
<h2 id="components-flow">Components flow</h2>
<p>The pipeline is strictly directional:</p>
<ul>
<li><strong>Parser</strong>: consumes raw logs and produces parsed log objects (structured fields, timestamps, variables).</li>
<li><strong>Detector</strong>: consumes parsed logs and generates alerts / findings when rules or models match anomalous behavior.</li>
</ul>
<p>Each arrow represents a stream of <a href="../schemas/">Schema objects</a>. Components are designed to run in the same process for lightweight setups or as separate services for scalable deployments.</p>
<p><img alt="DIAGRAM" src="../img/diagrams_structure.png" /></p>
<h2 id="components-architecture">Components architecture</h2>
<p>All components inherit from a <code>CoreComponent</code> class. This class provides all the essential functionality required for DetectMate to operate (see UML diagram below). Every <a href="../detectors/">Detector</a> must inherit from <code>CoreDetector</code>, and every <a href="../parsers/">Parser</a> must inherit from <code>CoreParser</code> to ensure compatibility with DetectMate.</p>
<p>Each componentâ€™s arguments must be stored in its corresponding configuration class. These config classes follow the same design pattern as their components and must inherit from <code>CoreConfig</code>.</p>
<p><img alt="UML" src="../img/uml_structure.png" /></p>
<h2 id="components-methods">Components methods</h2>
<p>Each Core* base class exposes a small, stable API that implementations must implement or may override.</p>
<pre><code class="language-python">class ConfigComponent(CoreConfig):
    &quot;&quot;&quot;Contains all the arguments of the component&quot;&quot;&quot;


class Component(CoreComponent):
    def run(
        self, input_: List[BaseSchema] | BaseSchema, output_: BaseSchema
    ) -&gt; bool:
    &quot;&quot;&quot;Run the component for a specific input&quot;&quot;&quot;

    def train(
        self, input_: List[BaseSchema] | BaseSchema,
    ) -&gt; None:
    &quot;&quot;&quot;Train the component with a specific input&quot;&quot;&quot;

    def process(self, data: BaseSchema | bytes) -&gt; BaseSchema | bytes | None:
    &quot;&quot;&quot;Process the data in a stream fashion (Defined in the CoreComponent)&quot;&quot;&quot;

    def get_config(self) -&gt; Dict[str, Any]:
    &quot;&quot;&quot;&quot;Get the configuration of the component (Defined in the CoreComponent)&quot;&quot;&quot;

    def update_config(self, new_config: Dict[str, Any]) -&gt; None:
    &quot;&quot;&quot;&quot;Update the configuration of the component (Defined in the CoreComponent)&quot;&quot;&quot;
</code></pre>
<p>Go back <a href="../">Index</a></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../implement_components/" class="btn btn-neutral float-left" title="Implement new component"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../schemas/" class="btn btn-neutral float-right" title="Schemas">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../implement_components/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../schemas/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
      <script src="../js/version-select.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
