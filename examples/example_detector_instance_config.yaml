# Example YAML configuration for DetectorInstance
# This shows how you can define both 'variables' and 'header-variables'
# at the same level, which will be combined into a single 'variables' list
# in the Python DetectorInstance object.


id: example_detector
event: 1
template: "User <*> performed action <*> on resource <*>"

# Regular variables (using integer IDs for template slots)
variables:
  - id: 0  # First <*> in template - username
    params:
      type: string
      validation: alphanumeric

  - id: 1  # Second <*> in template - action
    params:
      type: string
      allowed_values: ["login", "logout", "delete", "create"]

  - id: 2  # Third <*> in template - resource
    params:
      type: string
      max_length: 100

# Header variables (using string IDs for log headers/metadata)
header-variables:
  - id: Level
    params:
      default: INFO
      allowed_values: ["DEBUG", "INFO", "WARN", "ERROR"]

  - id: Timestamp
    params:
      format: iso8601
      required: true

  - id: Source
    params:
      default: "system"
      type: string

# When this YAML is loaded into a DetectorInstance object:
# - All variables from both 'variables' and 'header-variables' will be
#   combined into a single 'variables' list
# - The list will contain both DetectorVariable and HeaderVariable objects
# - Original type information is preserved (int IDs vs string IDs)
# - Template validation only applies to DetectorVariable objects (int IDs)
